<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PromptVault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Zigzag-like font -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    :root {
      --blue-main: #3b82f6;
      --blue-soft: #60a5fa;
      --card-bg: #050505;
      --border-subtle: #1f2933;
      --text-muted: #9ca3af;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Space Grotesk", system-ui, sans-serif;
      background: #000;
      color: #fff;
    }

    /* =================== HEADER (GRID MODE) =================== */
    header {
      text-align: center;
      padding: 32px 20px 16px;
    }

    h1 {
      margin: 0 0 14px;
      font-size: 2.2rem;
      letter-spacing: 0.25em;
      font-weight: 700;
      text-transform: uppercase;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .counter {
      color: var(--text-muted);
      font-size: 14px;
      margin-top: 6px;
    }

    .nav-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 16px 0 4px;
    }

    .nav-btn {
      background: #000;
      border: 1px solid var(--blue-main);
      color: var(--blue-main);
      padding: 9px 18px;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.18s;
    }

    .nav-btn:hover {
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
    }

    .nav-btn.active {
      background: var(--blue-main);
      color: #000;
      box-shadow: 0 0 18px rgba(59, 130, 246, 0.7);
    }

    /* =================== GRID MODE =================== */

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 20px 60px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 24px;
    }

    .card {
      background: #0b0b0b;
      border-radius: 22px;
      padding: 14px;
      border: 1px solid var(--border-subtle);
      transition: 0.25s;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 0 25px rgba(59, 130, 246, 0.35);
      border-color: var(--blue-main);
    }

    .img-box img {
      width: 100%;
      border-radius: 14px;
      display: block;
    }

    .prompt-text {
      font-size: 14px;
      color: #cbd5f5;
      margin: 12px 0;
      line-height: 1.6;
      max-height: 70px;
      overflow: hidden;
    }

    .card-actions {
      display: flex;
      gap: 10px;
    }

    .btn-action {
      flex: 1;
      background: #000;
      border: 1px solid var(--blue-main);
      color: #fff;
      padding: 9px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: 0.18s;
    }

    .btn-action:hover {
      background: var(--blue-main);
      color: #000;
    }

    /* =================== SHARE PAGE LAYOUT =================== */

    .container.share-mode {
      display: block;
      max-width: 720px;
      padding: 24px 16px 40px;
    }

    .share-page {
      max-width: 520px;
      margin: 0 auto;
    }

    .share-top-logo-bar {
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .share-logo-pill {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      font-size: 11px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: #e5e7eb;
      background: #000;
      opacity: 0.9;
    }

    .share-card {
      background: var(--card-bg);
      border-radius: 26px;
      border: 1px solid #111827;
      overflow: hidden;
      box-shadow: 0 32px 60px rgba(0, 0, 0, 0.85);
    }

    .share-main-image {
      position: relative;
      background: #000;
    }

    .share-main-image img {
      width: 100%;
      display: block;
      max-height: 520px;
      object-fit: cover;
    }

    /* Placeholder for reference thumbnails (bottom-right). 
       We don't have refs yet, so it's just hidden by default. */
    .share-refs {
      position: absolute;
      right: 14px;
      bottom: 14px;
      display: none; /* change to flex if you add reference images later */
      gap: 6px;
    }

    .share-ref-thumb {
      width: 48px;
      height: 64px;
      border-radius: 10px;
      overflow: hidden;
      border: 2px solid #000;
    }

    .share-ref-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .share-body {
      padding: 18px 18px 16px;
    }

    .share-title {
      font-size: 22px;
      font-weight: 700;
      margin: 4px 0 10px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .share-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .share-chip {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #111827;
      background: #020617;
      color: #e5e7eb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .share-chip i {
      font-size: 12px;
      color: var(--text-muted);
    }

    .share-prompt-box {
      position: relative;
      background: #020617;
      border-radius: 16px;
      padding: 12px 12px;
      border: 1px solid #111827;
      font-size: 14px;
      line-height: 1.7;
      color: #e5e7eb;
      max-height: 220px;
      overflow-y: auto;
    }

    .share-prompt-box::-webkit-scrollbar {
      width: 6px;
    }

    .share-prompt-box::-webkit-scrollbar-thumb {
      background: #374151;
      border-radius: 999px;
    }

    .share-actions-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 16px;
    }

    .share-btn-primary,
    .share-btn-secondary {
      border-radius: 999px;
      padding: 11px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .share-btn-primary {
      background: var(--blue-main);
      color: #000;
      box-shadow: 0 0 18px rgba(59, 130, 246, 0.6);
    }

    .share-btn-primary:hover {
      filter: brightness(1.05);
    }

    .share-btn-secondary {
      background: #fff;
      color: #000;
    }

    .share-btn-secondary:hover {
      background: #e5e7eb;
    }

    /* =================== TOAST =================== */

    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      color: #000;
      padding: 10px 22px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 13px;
      display: none;
      box-shadow: 0 18px 35px rgba(0, 0, 0, 0.8);
    }

    .toast.show {
      display: block;
    }
  </style>
</head>
<body>
  <header>
    <h1>PromptVault</h1>

    <nav class="nav-container">
      <button class="nav-btn active" onclick="filterCategory('midjourney')">Midjourney</button>
      <button class="nav-btn" onclick="filterCategory('nanobanana')">Nanobanana</button>
    </nav>

    <div class="counter" id="count-display">Loading...</div>
  </header>

  <main class="container" id="grid-area"></main>

  <div class="toast" id="toast">Copied!</div>

  <!-- Your prompts data -->
  <script src="index.js"></script>

  <script>
    const grid = document.getElementById("grid-area");
    const countDisplay = document.getElementById("count-display");
    const navContainer = document.querySelector(".nav-container");
    const navBtns = document.querySelectorAll(".nav-btn");
    const toast = document.getElementById("toast");

    const urlParams = new URLSearchParams(window.location.search);
    const sharedId = urlParams.get("id");

    if (typeof allPrompts === "undefined") {
      countDisplay.innerText = "Error: prompts.js not loaded";
    } else {
      if (sharedId) {
        renderSharedCard(sharedId);
      } else {
        renderPrompts("midjourney");
      }
    }

    // =================== SHARE PAGE ===================
    function renderSharedCard(id) {
      const data = allPrompts.find((p) => p.id == id);

      if (!data) {
        navContainer.style.display = "none";
        grid.classList.add("share-mode");
        grid.innerHTML = "<p>Prompt not found.</p>";
        countDisplay.innerText = "0 Prompts";
        return;
      }

      navContainer.style.display = "none";
      grid.classList.add("share-mode");

      const safePrompt = JSON.stringify(data.prompt);
      const title = data.title || `Prompt Style #${data.id}`;
      const categoryLabel =
        data.category === "midjourney" ? "Midjourney" : "NanoBanana";

      grid.innerHTML = `
        <section class="share-page">
          <div class="share-top-logo-bar">
            <div class="share-logo-pill">PROMPTVAULT</div>
          </div>

          <article class="share-card">
            <div class="share-main-image">
              <img src="${data.image}" alt="Prompt preview">
              <div class="share-refs"><!-- thumbnails if you add later --></div>
            </div>

            <div class="share-body">
              <h1 class="share-title">${title}</h1>

              <div class="share-chip-row">
                <div class="share-chip">
                  <i class="fa-regular fa-gem"></i>${categoryLabel}
                </div>
                <div class="share-chip">
                  <i class="fa-regular fa-message"></i>Prompt #${data.id}
                </div>
                <div class="share-chip">
                  <i class="fa-regular fa-eye"></i>Shared style
                </div>
              </div>

              <div class="share-prompt-box">
                ${data.prompt}
              </div>

              <div class="share-actions-row">
                <button class="share-btn-primary" onclick='copyText(${safePrompt})'>
                  <i class="fa-regular fa-copy"></i>
                  Copy prompt
                </button>
                <button class="share-btn-secondary" onclick="copyText(window.location.href)">
                  <i class="fa-solid fa-share-nodes"></i>
                  Share style
                </button>
              </div>
            </div>
          </article>
        </section>
      `;

      countDisplay.innerText = "Shared Prompt";
    }

    // =================== GRID MODE ===================
    function renderPrompts(category) {
      grid.classList.remove("share-mode");
      navContainer.style.display = "flex";

      navBtns.forEach((btn) => {
        btn.classList.toggle("active", btn.innerText.toLowerCase() === category);
      });

      const filtered = allPrompts.filter((p) => p.category === category);
      countDisplay.innerText = filtered.length + " Prompts";

      grid.innerHTML = filtered
        .map((item) => {
          const safePrompt = JSON.stringify(item.prompt);
          return `
          <div class="card">
            <div class="img-box">
              <img src="${item.image}" alt="Prompt image">
            </div>
            <div class="prompt-text">${item.prompt}</div>
            <div class="card-actions">
              <button class="btn-action" onclick='copyText(${safePrompt})'>
                <i class="fa-regular fa-copy"></i>
                Copy
              </button>
              <button class="btn-action" onclick="shareCard(${item.id})">
                <i class="fa-solid fa-share-nodes"></i>
                Share
              </button>
            </div>
          </div>`;
        })
        .join("");
    }

    function filterCategory(cat) {
      if (typeof allPrompts === "undefined") return;

      // Remove ?id= if present
      if (window.location.search.includes("id=")) {
        window.history.pushState({}, document.title, window.location.pathname);
      }
      renderPrompts(cat);
    }

    function shareCard(id) {
      const link =
        window.location.origin + window.location.pathname + "?id=" + id;
      copyText(link);
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        toast.textContent = "Copied!";
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2000);
      });
    }
  </script>
</body>
</html>
